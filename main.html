<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, interactive-widget=resizes-content">
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">

<meta name="description" content="Grow spiritually with this faith songs.">
 <script src="file:///assets/android.js"></script>
  <script src="file:///assets/main.js"></script>




		<title>Islamic songs</title>
<link href="familyMaterialIcons.css" rel="stylesheet">
	<link href="quicksand.css" rel="stylesheet">
	<link href="Teko.css" rel="stylesheet">
	<link rel="stylesheet" href="css/style.css">

<style>
html, body {
  height: 100%;
  overflow: hidden;
  -webkit-overflow-scrolling: touch;
}

.audio-player.hidden {
    display: none;
}

.audio-player__btn-top.active {
    color: #EB3700; /* Active state color */
}

.search-box {
  position: fixed; /* Position it over the navbar */
  right: 10px; /* Adjust the right position as needed */
  top: 0!important; /* Position it at the top of the navbar */
  z-index: 10; /* Ensure it appears above other navbar items */
  width: fit-content;
  height: 48px;
  border-radius: 25px; /* Match the rounded corners */
  padding: 5px; /* Add padding for some spacing */
}

#searchInput {
  height: 48px;
  width: 50px;
  border-style: none;
  padding: 10px;
  font-size: 18px;
  letter-spacing: 2px;
  outline: none;
  border-radius: 25px;
  transition: all 0.5s ease-in-out;
  background-color: transparent;
  padding-right: 40px;
  color: #fff;
  position: absolute;
  right: 0; /* Align it with the button */
  top: 0 !important; /* Align it with the button */
}

#searchInput::placeholder {
  color: grey;
  font-size: 18px;
  letter-spacing: 2px;
  font-weight: 100;
  top: 0 !important;
}

.btn-search {
  width: 50px;
  height: 48px;
  border-style: none;
  font-size: 20px;
  font-weight: bold;
  outline: none;
  cursor: pointer;
  border-radius: 50%;
  position: relative;
  z-index: 5; /* Ensure the button is above the input */
  color: #ffffff;
  background-color: transparent;
}

.btn-search:focus ~ #searchInput {
  width: 200px;
  border-radius: 0px;
  background-color: transparent;
  border-bottom: 1px solid rgba(255, 255, 255, 0.5);
  transition: all 500ms cubic-bezier(0, 0.110, 0.35, 2);
}

#searchInput:focus {
  width: 200px;
  border-radius: 0px;
  background-color: transparent;
  border-bottom: 1px solid rgba(255, 255, 255, 0.5);
  transition: all 500ms cubic-bezier(0, 0.110, 0.35, 2);
  top: 0 !important;
}

  .music-controller{
 transition: opacity 0.3s ease-in-out, visibility 0.3s ease-in-out;
    visibility: visible;
  }

  .music-controller.hidden {
    opacity: 0;
    visibility: hidden;
  }

    #ad-banner {
        transition: opacity 0.5s ease-in-out;
        opacity: 1;
    }

	.scrolling-text {
  width: 8rem;
  overflow: hidden;
  white-space: nowrap;
  position: relative;
}

.scrolling-text h3 {
  display: inline-block;
  padding-left: 100%;
  animation: scrollText 5s linear infinite;
}

@keyframes scrollText {
  0% { transform: translateX(100%); }
  100% { transform: translateX(-100%); }
}




 #recommended-play-btn {
        display: none;
    }

</style>
</head>
<body onload="pageLoaded()">
 <section class="loading-sec">

            <h1 class="nav-sec__logo-inner">
			<div class="loader"></div>
                </span>
            </h1>
        </div>
    </section>
    <!-- Created Two Layout-Grid -->
   <div class="main">
            <!-- Navigation Section Start -->
	  <nav class="navbar">
	
    <span id="btn" class="material-icons">menu</span>
	
	<div class="search-box">
	
    <button class="btn-search"> <span class="material-icons">search</span></button>

   <input type="text" id="searchInput" placeholder="Search..." />
  </div>

  </nav>
  <div class="side-menu" id="menu">
 <ul>
 <!-- Rate us -->
  

<!-- Privacy policy-->
<li>
    <a href="https://dirajumla.blogspot.com/p/privacy-policy.html" id="privacy" onclick="openPrivaceLink()">
        <span class="material-icons">security</span>
        Privacy
    </a>
</li>
</ul>
  </div>
  <div class="back">

  </div>
            <section class="nav-sec">
            </section>
             <!-- Navigation Section End -->
<br /><br /><br /><br />
            <!-- Musics Section Start -->
            <section class="music-sec">

                <!-- Top Cover Start-->
<div class="cover">
    <img id="cover-img" src="img/cover6p.jpg" alt="" class="cover__img">
    <div class="cover__text">
        <h1 class="cover__title"></h1>
        <a href="#" class="btn cover__play-btn" id="recommended-play-btn">
            <span>Play Now</span>
            <span class="material-icons">play_circle_filled</span>
        </a>
    </div>
</div>


                 <!-- Top Cover End-->

                 <div class="music-con">
                      <div style="display: flex; align-items: center; justify-content: space-between; padding: 0 2rem;">
                          <h1 class="heading-sec"></h1>
                          <button class="favorite-filter-btn" id="favorite-filter-btn" title="Show Favorites">
                              <span class="material-icons">star</span>
                              <span class="favorite-text">Favourite</span>
                          </button>
                      </div>

                    <!-- Music List Scroll Start-->
                    <div class="music-con__list scroll-bar-hide">
                    </div>

                      <!-- Music List Scroll End-->
                 </div>
                 <div class="music-hor music-con">
                   <h1 class="music-con__heading heading-sec">Nasheed</h1>
                    <div class="music-hor__list">
                    </div>
                </div>
                <div class="music-con">

                    <h1 class="heading-sec">Latest</h1>
                    <!-- Music List Scroll Start 2-->

                    <div class="music-con__list scroll-bar-hide">

                                              -->
                    </div>
                      <!-- Music List Scroll End 2-->
                 </div>
                      <!-- Music List Scroll End-->
                 </div>
                </div>
                <div class="music-con">
                    <!-- Music List Scroll Start 2-->
                    <div class="music-con__list scroll-bar-hide">

                                              -->

                    </div>
                      <!-- Music List Scroll End 2-->
                 </div>

            </section>
            <!-- Musics Section End -->
    </main>

    <!-- Music { Play Btn  /  Progress Bar / }  Start-->
    <section class="music-controller">
                  <!-- Progress Bar-->
		<div class="music-controller__progress-bar-wrapper">
     <!-- Collapse Icon -->


        <div class="music-controller__list">
                <div class="music-controller__item">
                    <img src="img/DeenAssalam.webp" alt="" class="music-controller__img audio-image">
					<div class="scrolling-text">
                       <h3 class="music-artist-name audio-name">Yaseen</h3>
                        </div>

                </div>
                <div class="music-controller__item">
<!--  skip prev -->
                    <div class="music-controller__btn audio-prev-btn">
                        <span class="material-icons">
                            skip_previous
                        </span>
                    </div>
<!--  Play button -->
                    <div class="music-controller__btn audio-play-pause-btn">
                        <span class="material-icons">
                            play_circle_filled
                           </span>
                    </div>
					<!--  skip next -->
                    <div class="music-controller__btn audio-next-btn">
                        <span class="material-icons">
                            skip_next
                        </span>

                    </div>

                </div>
                <div class="music-controller__item phone-disable">

                    <div class="music-controller__btn audio-shuffle">
                        <span class="material-icons">
                            shuffle
                         </span>
                    </div>
                    <div class="music-controller__btn audio-volume">
                        <span class="material-icons">
                            volume_up
                        </span>
                    </div>
                    <div class="music-controller__btn audio-repeat">
                        <span class="material-icons">
                            repeat
                         </span>
                    </div>

                </div>
        </div>
    </section>

  <!--- Open Music Player-->
  <!--  Audio player -->
<section class="audio-player hidden" id="audio-player-fullscreen">
    <div class="audio-player__wrapper">
        <img src="img/ApongezweMama.jpg" alt="" class="audio-player__img audio-image">
        <div class="audio-player__text">
          <center>  <h3 class="heading-3 audio-name">Yaseen</h3> </center>
            <p class="music-artist-name audio-singer-name">Yaseen</p>
        </div>

        <div class="audio-player__item audio-player__item--1">
            <div class="audio-player__btn-top audio-shuffle">
                <span class="material-icons">shuffle</span>
            </div>
            <div class="audio-player__btn-top audio-favorite-toggle" id="audio-favorite-toggle">
                <span class="material-icons">star_border</span>
            </div>
            <div class="audio-player__btn-top audio-repeat">
                <span class="material-icons">repeat</span>
            </div>
        </div>

        <div class="audio-player__timing-update">
            <h3 class="audio-time" id="current-duration">01:06</h3>
            <h3 class="audio-time" id="end-duration">03:45</h3>
        </div>

		<div class="audio-player__item">
  <div class="audio-player__progress-bar_wrapper">

      <div class="music-controller__progress-bar audio-player__progress-bar">
        <span class="music-controller__progress-bar-fill"></span>
      </div>

  </div>
</div>
        <div class="audio-player__item audio-player__item--playBtn">
            <div class="audio-player__btn-bottom audio-prev-btn">
                <span class="material-icons">skip_previous</span>
            </div>
            <div class="audio-player__btn-bottom audio-play-pause-btn">
                <span class="material-icons">play_circle_filled</span>
            </div>
            <div class="audio-player__btn-bottom audio-next-btn">
                <span class="material-icons">skip_next</span>
            </div>
        </div>
    </div>
</section>

     <!-- Music { Play Btn  /  Progress Bar / }  End-->

    <audio id="audio" class="audio" style="display: none;">
    <source src="play/ramadan.mp3"></source>
</audio>
    <!-- Including External JavaScript File Here -->

    <script src="script.js"></script>
	<script src="fonts/hammer.min.js"></script>

 <script src="fonts/jquery.min.js"></script>

<!-- changes added script for menu-->
  <script>
const btn = document.getElementById("btn"); // The button element
  const menu = document.querySelector(".side-menu"); // Optional: Link to the side menu if needed
  const backOverlay = document.querySelector(".back"); // Optional: Link to the back overlay
  let isMenuOpen = false; // Track the menu state

  // Handle button click
  btn.addEventListener("click", () => {
    isMenuOpen = !isMenuOpen;

    if (isMenuOpen) {
      btn.innerHTML = "arrow_back"; // Switch icon text
      btn.classList.add("rotate"); // Add class for animation
      menu?.classList.add("act"); // Optional: Open the side menu
      backOverlay?.classList.add("act"); // Optional: Show overlay
    } else {
      btn.innerHTML = "menu"; // Switch icon text back
      btn.classList.remove("rotate"); // Remove animation class
      menu?.classList.remove("act"); // Optional: Close the side menu
      backOverlay?.classList.remove("act"); // Optional: Hide overlay
    }
  });

  // Optional: Close menu when clicking outside
  document.addEventListener("click", (e) => {
    if (!btn.contains(e.target) && isMenuOpen && !menu?.contains(e.target)) {
      isMenuOpen = false;
      btn.innerHTML = "menu"; // Reset button text
      btn.classList.remove("rotate"); // Reset animation
      menu?.classList.remove("act"); // Close the side menu
      backOverlay?.classList.remove("act"); // Hide overlay
    }
  });

  // Optional: Close menu when clicking the overlay
  backOverlay?.addEventListener("click", () => {
    isMenuOpen = false;
    btn.innerHTML = "menu"; // Reset button text
    btn.classList.remove("rotate"); // Reset animation
    menu?.classList.remove("act"); // Close the side menu
    backOverlay?.classList.remove("act"); // Hide overlay
  });
</script>

<!-- changes removed-->
  <script>
 class PlayedSongsStorage {
    static storageKey = 'playedSongs';

    // Save a played song to localStorage
    static savePlayedSong(songUrl) {
        const playedSongs = this.getPlayedSongs();
        if (!playedSongs.includes(songUrl)) {
            playedSongs.push(songUrl);
            localStorage.setItem(this.storageKey, JSON.stringify(playedSongs));
        }
    }

    // Retrieve all played songs from localStorage
    static getPlayedSongs() {
        const playedSongs = localStorage.getItem(this.storageKey);
        return playedSongs ? JSON.parse(playedSongs) : [];
    }


}

  </script>

  


<script>

// Add the 'loaded' class to the body after the page loads
document.addEventListener("DOMContentLoaded", () => {
  document.body.classList.add("loaded");
});

</script>
<script>
//control music controller when opening full full screen player
// Get the elements by their class and ID
const controllerItem = document.querySelector('.music-controller');
const audioPlayer = document.getElementById('audio-player-fullscreen');

// Add a click event listener to the progress bar wrapper
controllerItem.addEventListener('click', function (event) {
    // Check if the click originated from a button or its child elements
    const isExcluded = event.target.closest('.audio-prev-btn, .audio-play-pause-btn, .audio-next-btn');

    // If it's a button, stop propagation and do nothing
    if (isExcluded) return;

    // Toggle the 'hidden' class on the audio player section
    audioPlayer.classList.toggle('hidden');
});

// Add explicit click event listeners for buttons to stop propagation
const buttons = document.querySelectorAll('.audio-prev-btn, .audio-play-pause-btn, .audio-next-btn');
buttons.forEach(button => {
    button.addEventListener('click', function (event) {
        // Stop the click event from propagating to the wrapper
        event.stopPropagation();
    });
});

// Select all control items (repeat, shuffle, etc.)
const controlItems = document.querySelectorAll('.audio-player__btn-top');

// Add click event to toggle the active state
controlItems.forEach(item => {
    item.addEventListener('click', () => {
        item.classList.toggle('active');
    });
});
</script>


<script>
// External songs management
class ExternalSongsManager {
    static externalSongs = [];
    static isLoaded = false;
    static isLoading = false;

    static async loadExternalSongs() {
        if (this.isLoaded || this.isLoading) return;

        this.isLoading = true;
        try {
            const response = await fetch('https://storage.dirajumla-publishers.com/kaswida/moresongs.json');
            if (response.ok) {
                this.externalSongs = await response.json();
                this.isLoaded = true;
                console.log('External songs loaded:', this.externalSongs.length);
            } else {
                console.warn('Failed to load external songs');
            }
        } catch (error) {
            console.error('Error loading external songs:', error);
        } finally {
            this.isLoading = false;
        }
    }

    static searchExternalSongs(query) {
        return this.externalSongs.filter(song => {
            const name = (song.name || '').toLowerCase();
            const artist = (song.artist || '').toLowerCase();
            return name.includes(query) || artist.includes(query);
        });
    }

    static renderExternalSongs(songs) {
        const horList = document.querySelector('.music-hor__list');
        if (!horList) return;

        // Remove previous external songs
        document.querySelectorAll('.music-hor__item[data-external="true"]').forEach(item => {
            item.remove();
        });

        // Add matching external songs
        songs.forEach((song, index) => {
            const content = `<div class="music-hor__item" data-external="true" data-external-index="${index}">
                                <div class="music-hor__item-inner">
                                    <img src="img/${song.image}" class="music-hor__img">
                                    <h3 class="music-artist-name">${song.name}</h3>
                                </div>
                                <div class="music-hor__item-inner">
                                    <p class="music-hor__music-duration">${song.duration}</p>
                                </div>
                            </div>`;
            horList.insertAdjacentHTML('beforeend', content);
        });

        // Reattach click listeners for external songs
        this.attachExternalSongListeners();
    }

    static attachExternalSongListeners() {
        const externalItems = document.querySelectorAll('.music-hor__item[data-external="true"]');
        externalItems.forEach(item => {
            item.addEventListener('click', function() {
                const index = parseInt(this.getAttribute('data-external-index'));
                const song = ExternalSongsManager.externalSongs[index];

                // Play the external song
                const audioElement = document.getElementById('audio');
                if (audioElement && song) {
                    audioElement.src = `play/${song.songUrl}`;

                    // Update UI
                    document.querySelectorAll('.audio-image').forEach(img => {
                        img.src = `img/${song.image}`;
                    });
                    document.querySelectorAll('.audio-name').forEach(name => {
                        name.textContent = song.name;
                    });
                    const singerName = document.querySelector('.audio-singer-name');
                    if (singerName) {
                        singerName.textContent = song.artist || song.name;
                    }

                    audioElement.play();

                    // Update play button icon
                    document.querySelectorAll('.audio-play-pause-btn .material-icons').forEach(icon => {
                        icon.textContent = 'pause_circle_filled';
                    });

                    // Open fullscreen player if hidden
                    const fullscreen = document.getElementById('audio-player-fullscreen');
                    if (fullscreen && fullscreen.classList.contains('hidden')) {
                        fullscreen.classList.remove('hidden');
                    }
                }
            });
        });
    }

    static clearExternalSongs() {
        document.querySelectorAll('.music-hor__item[data-external="true"]').forEach(item => {
            item.remove();
        });
    }
}

// Load external songs on page load
document.addEventListener('DOMContentLoaded', () => {
    ExternalSongsManager.loadExternalSongs();
});
</script>

<script>
// Enhanced unified search functionality
document.addEventListener('DOMContentLoaded', () => {
    const searchInput = document.getElementById('searchInput');

    if (!searchInput) return;

    searchInput.addEventListener('input', async () => {
        const query = searchInput.value.toLowerCase().trim();

        // Search in music-con__item (vertical scroll list)
        const musicItems = document.querySelectorAll('.music-con__item');
        musicItems.forEach(item => {
            const artistName = item.querySelector('.music-artist-name')
                ? item.querySelector('.music-artist-name').textContent.toLowerCase()
                : '';

            const headingText = item.querySelector('.heading-3')
                ? item.querySelector('.heading-3').textContent.toLowerCase()
                : '';

            if (artistName.includes(query) || headingText.includes(query)) {
                item.style.display = '';
            } else {
                item.style.display = 'none';
            }
        });

        // Search in music-hor__item (horizontal list - local songs only)
        const horItems = document.querySelectorAll('.music-hor__item:not([data-external="true"])');
        horItems.forEach(item => {
            const artistName = item.querySelector('.music-artist-name')
                ? item.querySelector('.music-artist-name').textContent.toLowerCase()
                : '';

            if (artistName.includes(query)) {
                item.style.display = '';
            } else {
                item.style.display = 'none';
            }
        });

        // Handle external songs
        if (query) {
            // Search external songs if loaded
            if (ExternalSongsManager.isLoaded) {
                const matchingSongs = ExternalSongsManager.searchExternalSongs(query);
                ExternalSongsManager.renderExternalSongs(matchingSongs);
            } else if (!ExternalSongsManager.isLoading) {
                // Load external songs if not already loading
                await ExternalSongsManager.loadExternalSongs();
                const matchingSongs = ExternalSongsManager.searchExternalSongs(query);
                ExternalSongsManager.renderExternalSongs(matchingSongs);
            }
        } else {
            // Clear search - show all local songs and hide external songs
            musicItems.forEach(item => item.style.display = '');
            horItems.forEach(item => item.style.display = '');
            ExternalSongsManager.clearExternalSongs();
        }
    });
});
</script>

<script>


// Hide music controller when search botton clicked

const btnSearch = document.querySelector('.btn-search');

    const musicController = document.querySelector('.music-controller');

    // Hide music controller when search button is clicked
    btnSearch.addEventListener('click', () => {
      musicController.classList.add('hidden');
    });

    // Show music controller when clicking outside the search input
    document.addEventListener('click', (event) => {
      if (!searchInput.contains(event.target) && !btnSearch.contains(event.target)) {
        musicController.classList.remove('hidden');
      }
    });

    // Prevent reshowing when clicking on search button again
    btnSearch.addEventListener('click', (event) => {
      event.stopPropagation();
    });

    // Prevent hiding or showing behavior when focusing inside the search input
    searchInput.addEventListener('click', (event) => {
      event.stopPropagation();
    });

	//hide navigation search menu when full player is active

	// Select elements

const searchBox = document.querySelector('.search-box');

// Function to check and toggle the visibility of the search box
function toggleSearchBox() {
  // Check if the audio player has the "hidden" class or if its height is 0px
  const isHidden = audioPlayer.classList.contains('hidden') || window.getComputedStyle(audioPlayer).height === '0px';

  if (!isHidden) {
    searchBox.style.display = 'none'; // Hide the search box when audio player is visible (100% height)
  } else {
    searchBox.style.display = 'block'; // Show the search box when audio player is hidden
  }
}

// Add an observer to monitor class changes and height changes
const mutationObserver = new MutationObserver(toggleSearchBox);
mutationObserver.observe(audioPlayer, { attributes: true, attributeFilter: ['class'] });

// Initial check
toggleSearchBox();

	//lock navigation bar so keyboard can't push it

	function lockNavbarHeight() {
    const navbar = document.querySelector('.navbar');
    const navbarHeight = navbar.offsetHeight;
    navbar.style.height = `${navbarHeight}px`;

    window.addEventListener('resize', () => {
        // Ensure keyboard resizing doesn't affect navbar
        navbar.style.height = `${navbarHeight}px`;
    });
}

document.addEventListener('DOMContentLoaded', lockNavbarHeight);

// Control back button exit on full screen

document.addEventListener("DOMContentLoaded", function () {
    let audioPlayer = document.getElementById("audio-player-fullscreen");

    if (audioPlayer) {
        window.history.pushState(null, null, window.location.href); // Push a new state

        window.addEventListener("popstate", function (event) {
            if (!audioPlayer.classList.contains("hidden")) {
                event.preventDefault(); // Prevent app from exiting
                audioPlayer.classList.add("hidden"); // Hide the player
                window.history.pushState(null, null, window.location.href); // Push state again
            } else {
                window.history.back(); // Allow normal back behavior
            }
        });
    }
});

</script>


<script>
//disable banner ad when keyboard is active
document.addEventListener("DOMContentLoaded", function () {
    let originalHeight = window.innerHeight;
    let adHidden = false;

    // Hide banner ad with smooth fade-out
    function hideAdSmoothly() {
        let adBanner = document.getElementById("ad-banner");
        if (adBanner) {
            adBanner.style.transition = "opacity 0.5s ease";
            adBanner.style.opacity = "0";
            setTimeout(() => {
                if (typeof android !== "undefined" && android.control && typeof android.control.dispatchEvent === "function") {
                    android.control.dispatchEvent("hideBanner", []); // Hide AdMob banner ad
                }
            }, 500);
        } else {
            if (typeof android !== "undefined" && android.control && typeof android.control.dispatchEvent === "function") {
                android.control.dispatchEvent("hideBanner", []); // Fallback if element is missing
            }
        }
    }

    // Show banner ad with smooth fade-in
    function showAdSmoothly() {
        let adBanner = document.getElementById("ad-banner");
        if (typeof android !== "undefined" && android.control && typeof android.control.dispatchEvent === "function") {
            android.control.dispatchEvent("showBanner", []); // Show AdMob banner ad
        }
        if (adBanner) {
            setTimeout(() => {
                adBanner.style.transition = "opacity 0.3s ease";
                adBanner.style.opacity = "1";
            }, 100);
        }
    }

    // Detect keyboard open/close based on viewport height
    window.addEventListener("resize", function () {
        if (window.innerHeight < originalHeight * 0.8) {
            // Keyboard likely opened → hide banner
            if (!adHidden) {
                adHidden = true;
                hideAdSmoothly();
            }
        } else {
            // Keyboard likely closed → show banner again
            if (adHidden) {
                adHidden = false;
                showAdSmoothly();
            }
        }
    });
});



//make progress fill draggable
document.addEventListener("DOMContentLoaded", function () {
    const progressBarWrapper = document.querySelector(".audio-player__progress-bar_wrapper");
    const progressBar = document.querySelector(".audio-player__progress-bar");
    const progressFill = document.querySelector(".music-controller__progress-bar-fill");
    const player = document.querySelector("audio"); // Reference the audio player

    let isDragging = false;

    function updateProgress(event) {
        const rect = progressBar.getBoundingClientRect();
        const offsetX = event.type.includes("touch") ? event.touches[0].clientX - rect.left : event.clientX - rect.left;
        let percent = (offsetX / rect.width) * 100;
        percent = Math.max(0, Math.min(100, percent)); // Ensure within bounds
        progressFill.style.width = percent + "%";

        if (player.duration) {
            player.currentTime = (percent / 100) * player.duration; // Update actual audio position live
        }
    }

    progressBarWrapper.addEventListener("mousedown", (event) => {
        isDragging = true;
        updateProgress(event);
    });

    document.addEventListener("mousemove", (event) => {
        if (isDragging) {
            updateProgress(event);
        }
    });

    document.addEventListener("mouseup", () => {
        isDragging = false;
    });

    // Support for touch events
    progressBarWrapper.addEventListener("touchstart", (event) => {
        isDragging = true;
        updateProgress(event);
    });

    document.addEventListener("touchmove", (event) => {
        if (isDragging) {
            updateProgress(event);
        }
    });

    document.addEventListener("touchend", () => {
        isDragging = false;
    });

    // Keep progress bar updated with audio time
    player.addEventListener("timeupdate", () => {
        if (!isDragging) {
            let percent = (player.currentTime / player.duration) * 100;
            progressFill.style.width = percent + "%";
        }
    });
});


//admob integration

document.addEventListener("DOMContentLoaded", function () {
    let lastAdTime = 0;

    // Show AdMob ad if ready and cooldown passed
    function showAdIfReady() {
        const currentTime = Date.now();
        if (currentTime - lastAdTime >= 35000) { // 35 sec cooldown
            if (typeof android !== "undefined" && android.control && typeof android.control.dispatchEvent === "function") {
                android.control.dispatchEvent("showAd", []);
                lastAdTime = currentTime; // Update last shown time
            } else {
                console.warn("AdMob bridge not available");
            }
        }
    }

    // Listen for clicks on specific elements dynamically
    document.body.addEventListener("click", function (event) {
        if (
            event.target.closest(".music-con__img") ||
            event.target.closest(".music-hor__item") ||
            event.target.closest(".music-hor__item-inner")
        ) {
            showAdIfReady();
        }
    });
});





// update cover image
document.addEventListener("DOMContentLoaded", () => {
    // Array of cover images
    const images = [
       
        "img/Yaa Rasullahh.jpg",
		"img/cover5p.jpg",
		"img/cover6p.jpg",
		"img/cover7p.jpg"
    ];

    const coverImg = document.getElementById("cover-img");
    let currentIndex = 0;

    // Preload images to avoid flicker
    images.forEach(src => {
        const img = new Image();
        img.src = src;
    });

    function changeImage() {
        // Fade out
        coverImg.style.opacity = "0";

        // Wait for fade-out before changing the image
        setTimeout(() => {
            // Move to the next image index
            currentIndex = (currentIndex + 1) % images.length;

            // Change the image source
            coverImg.src = images[currentIndex];

            // Fade in
            coverImg.style.opacity = "1";
        }, 800); // Match the transition duration in CSS
    }

    // Change the image every 5 seconds
    setInterval(changeImage, 62000);
});





// Click handler for music items to open fullscreen player
document.addEventListener('click', function(event) {
    const musicConImg = event.target.closest('.music-con__img');
    const musicHorItem = event.target.closest('.music-hor__item');

    if (musicConImg || musicHorItem) {
        const audioPlayerFullscreen = document.getElementById('audio-player-fullscreen');
        if (audioPlayerFullscreen && audioPlayerFullscreen.classList.contains('hidden')) {
            audioPlayerFullscreen.classList.remove('hidden');
        }
    }
});
</script>

<script>
// Favorite functionality
class FavoriteSongs {
    static storageKey = 'favoriteSongs';

    static getFavorites() {
        const favorites = localStorage.getItem(this.storageKey);
        return favorites ? JSON.parse(favorites) : [];
    }

    static saveFavorites(favorites) {
        localStorage.setItem(this.storageKey, JSON.stringify(favorites));
    }

    static isFavorite(songUrl) {
        const favorites = this.getFavorites();
        return favorites.includes(songUrl);
    }

    static toggleFavorite(songUrl) {
        const favorites = this.getFavorites();
        const index = favorites.indexOf(songUrl);

        if (index === -1) {
            favorites.push(songUrl);
        } else {
            favorites.splice(index, 1);
        }

        this.saveFavorites(favorites);
        return index === -1;
    }
}

function showToast(message) {
    let toast = document.getElementById('favorite-toast');
    if (!toast) {
        toast = document.createElement('div');
        toast.id = 'favorite-toast';
        toast.style.cssText = `
            position: fixed;
            bottom: 100px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(50, 50, 50, 0.95);
            color: white;
            padding: 14px 24px;
            border-radius: 8px;
            z-index: 10000;
            font-size: 14px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
            opacity: 0;
            transition: opacity 0.3s ease;
        `;
        document.body.appendChild(toast);
    }

    toast.textContent = message;
    toast.style.opacity = '1';

    setTimeout(() => {
        toast.style.opacity = '0';
    }, 2500);
}

let isFilteringFavorites = false;
let originalMusicItems = [];
let originalHorItems = [];

function showLoader() {
    const loadingSec = document.querySelector('.loading-sec');
    if (loadingSec) {
        loadingSec.style.opacity = '1';
        loadingSec.style.visibility = 'visible';
        loadingSec.style.zIndex = '10000';
    }
}

function hideLoader() {
    const loadingSec = document.querySelector('.loading-sec');
    if (loadingSec) {
        setTimeout(() => {
            loadingSec.style.opacity = '0';
            setTimeout(() => {
                loadingSec.style.visibility = 'hidden';
                loadingSec.style.zIndex = '100';
            }, 500);
        }, 800);
    }
}

function filterFavorites() {
    const filterBtn = document.getElementById('favorite-filter-btn');
    const favorites = FavoriteSongs.getFavorites();

    if (!isFilteringFavorites) {
        showLoader();

        setTimeout(() => {
            if (favorites.length === 0) {
                hideLoader();
                showToast('No favorite songs');
                return;
            }

            const musicConItems = document.querySelectorAll('.music-con__item');
            const musicHorItems = document.querySelectorAll('.music-hor__item');

            let foundFavorites = false;

            musicConItems.forEach(item => {
                const index = parseInt(item.getAttribute('data-original-index'));
                const songUrl = window.getSongs?.songs?.[index]?.songUrl;

                if (songUrl && favorites.includes(songUrl)) {
                    item.style.display = '';
                    foundFavorites = true;
                } else {
                    item.style.display = 'none';
                }
            });

            musicHorItems.forEach(item => {
                const index = parseInt(item.getAttribute('data-original-index'));
                const songUrl = window.getSongs?.animeSong?.[index]?.songUrl;

                if (songUrl && favorites.includes(songUrl)) {
                    item.style.display = '';
                    foundFavorites = true;
                } else {
                    item.style.display = 'none';
                }
            });

            if (!foundFavorites) {
                showToast('No favorite songs');
                musicConItems.forEach(item => item.style.display = '');
                musicHorItems.forEach(item => item.style.display = '');
            } else {
                isFilteringFavorites = true;
                filterBtn.classList.add('active');
            }

            hideLoader();
        }, 1000);
    } else {
        const musicConItems = document.querySelectorAll('.music-con__item');
        const musicHorItems = document.querySelectorAll('.music-hor__item');

        musicConItems.forEach(item => item.style.display = '');
        musicHorItems.forEach(item => item.style.display = '');

        isFilteringFavorites = false;
        filterBtn.classList.remove('active');
    }
}

function updateFavoriteIcon() {
    const audioElement = document.getElementById('audio');
    const favoriteToggle = document.getElementById('audio-favorite-toggle');

    if (!audioElement || !favoriteToggle) return;

    const currentSrc = audioElement.getAttribute('src');
    if (!currentSrc) return;

    const songUrl = currentSrc.split('/').pop();
    const isFavorited = FavoriteSongs.isFavorite(songUrl);

    const icon = favoriteToggle.querySelector('.material-icons');
    if (isFavorited) {
        icon.textContent = 'star';
        favoriteToggle.classList.add('favorited');
    } else {
        icon.textContent = 'star_border';
        favoriteToggle.classList.remove('favorited');
    }
}

document.addEventListener('DOMContentLoaded', function() {
    const filterBtn = document.getElementById('favorite-filter-btn');
    const favoriteToggle = document.getElementById('audio-favorite-toggle');
    const audioElement = document.getElementById('audio');

    if (filterBtn) {
        filterBtn.addEventListener('click', filterFavorites);
    }

    if (favoriteToggle) {
        favoriteToggle.addEventListener('click', function(e) {
            e.stopPropagation();

            const currentSrc = audioElement.getAttribute('src');
            if (!currentSrc) {
                showToast('No song is playing');
                return;
            }

            const songUrl = currentSrc.split('/').pop();
            const isFavorited = FavoriteSongs.toggleFavorite(songUrl);

            updateFavoriteIcon();

            showToast(isFavorited ? 'Added to favorites' : 'Removed from favorites');

            if (isFilteringFavorites) {
                setTimeout(() => {
                    filterFavorites();
                    filterFavorites();
                }, 300);
            }
        });
    }

    if (audioElement) {
        audioElement.addEventListener('loadedmetadata', updateFavoriteIcon);
        audioElement.addEventListener('play', updateFavoriteIcon);
    }

    setTimeout(updateFavoriteIcon, 1000);
});
</script>

</body>
</html>